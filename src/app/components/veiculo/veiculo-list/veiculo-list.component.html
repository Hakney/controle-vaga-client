<div class="card">
    <p-toast></p-toast>
    <p-table [value]="veiculos" dataKey="id" editMode="row" [tableStyle]="{'min-width': '50rem'}">
        <ng-template pTemplate="header">
            <tr>
                <th style="width:20%">Apartamento</th>
                <th style="width:20%">Marca</th>
                <th style="width:20%">Modelo</th>
                <th style="width:20%">Cor</th>
                <th style="width:20%">Placa</th>
                <th style="width:20%; text-align: center;">Ações</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-veiculo let-editing="editing" let-ri="rowIndex">
            <tr [pEditableRow]="veiculo">
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <p-dropdown 
                                [options]="apartamentos" 
                                optionLabel="label" 
                                optionValue="id" 
                                [(ngModel)]="veiculo.apartamento.id" 
                                name="apartamentoid" 
                                [appendTo]="'body'"
                                required>
                            </p-dropdown>
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{ getApartamentoLabel(veiculo.apartamento.id) }}
                          </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="veiculo.marca" required />
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{veiculo.marca}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="veiculo.modelo" required />
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{veiculo.modelo}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="veiculo.cor" required />
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{veiculo.cor}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <p-cellEditor>
                        <ng-template pTemplate="input">
                            <input pInputText type="text" [(ngModel)]="veiculo.placa" required />
                        </ng-template>
                        <ng-template pTemplate="output">
                            {{veiculo.placa}}
                        </ng-template>
                    </p-cellEditor>
                </td>
                <td>
                    <div style="display: flex; gap: 0.5rem; justify-content: center; align-items: center;">
                        <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                            (click)="onRowEditInit(veiculo)" class="p-button-rounded p-button-text">
                        </button>
                        <button *ngIf="!editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-trash"
                            (click)="onRowDelete(veiculo)"
                            class="p-button-rounded p-button-text p-button-danger">
                        </button>
                        <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                            (click)="onRowEditSave(veiculo)"
                            class="p-button-rounded p-button-text p-button-success mr-2">
                        </button>
                        <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"
                            (click)="onRowEditCancel(veiculo, ri)"
                            class="p-button-rounded p-button-text p-button-danger">
                        </button>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <br />
    <div style="display: flex; justify-content: flex-end;">
        <p-button (click)="redirectToForm()">Novo veículo</p-button>
    </div>
</div>
